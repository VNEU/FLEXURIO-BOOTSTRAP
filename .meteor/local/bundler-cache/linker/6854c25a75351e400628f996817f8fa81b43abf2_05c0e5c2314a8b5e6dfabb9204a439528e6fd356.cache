[{"type":"js","data":"(function () {\n\n/* Imports */\nvar Meteor = Package.meteor.Meteor;\nvar global = Package.meteor.global;\nvar meteorEnv = Package.meteor.meteorEnv;\n\n/* Package-scope variables */\nvar ExportCSV, line, exportcsv, saveAs;\n\n(function(){\n\n//////////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                          //\n// packages/lfergon_exportcsv/packages/lfergon_exportcsv.js                                 //\n//                                                                                          //\n//////////////////////////////////////////////////////////////////////////////////////////////\n                                                                                            //\n(function () {\n\n////////////////////////////////////////////////////////////////////////////////////////\n//                                                                                    //\n// packages/lfergon:exportcsv/lib/exportcsv.js                                        //\n//                                                                                    //\n////////////////////////////////////////////////////////////////////////////////////////\n                                                                                      //\nExportCSV = function() {                                                              // 1\n                                                                                      // 2\n};                                                                                    // 3\n                                                                                      // 4\n/**                                                                                   // 5\n * [exportcsv description]                                                            // 6\n * @param  {[type]} dataFromCollection [description]                                  // 7\n * @return {[type]}                    [description]                                  // 8\n */                                                                                   // 9\nExportCSV.prototype.exportToCSV = function (dataFromCollection, heading, delimiter) { // 10\n  heading = heading ? heading : true;                                                 // 11\n  delimiter = delimiter ? delimiter : \",\";                                            // 12\n                                                                                      // 13\n  if (dataFromCollection && dataFromCollection.length === 0) {                        // 14\n    return 'Not a valid array';                                                       // 15\n  }                                                                                   // 16\n  if (dataFromCollection === undefined) {                                             // 17\n    return 'No results for the query';                                                // 18\n  }                                                                                   // 19\n  var str = '';                                                                       // 20\n  // var line = '';                                                                   // 21\n  // if (dataFromCollection.length > 0) {                                             // 22\n  //   for (var property in dataFromCollection[0]) {                                  // 23\n  //     if (dataFromCollection[0].hasOwnProperty(property)) {                        // 24\n  //       line += property + delimiter;                                              // 25\n  //     }                                                                            // 26\n  //   }                                                                              // 27\n  //   str += line.slice(0, -1) + '\\r\\n';                                             // 28\n  // }                                                                                // 29\n                                                                                      // 30\n  // Insert heading values                                                            // 31\n  if (heading) {                                                                      // 32\n    var heading = Object.keys(dataFromCollection[0])                                  // 33\n    str += heading.join(delimiter) + \"\\r\\n\"                                           // 34\n  }                                                                                   // 35\n                                                                                      // 36\n  // Generate CSV                                                                     // 37\n  for (var i = 0; i < dataFromCollection.length; i++) {                               // 38\n    var lineFor = '';                                                                 // 39\n    for (var key in dataFromCollection[i]) {                                          // 40\n      if (dataFromCollection[i].hasOwnProperty(key)){                                 // 41\n        var data = dataFromCollection[i][key];                                        // 42\n        var dataString;                                                               // 43\n                                                                                      // 44\n        if (typeof data === 'number')                                                 // 45\n          dataString = data.toString();                                               // 46\n        else                                                                          // 47\n          dataString = data.toString(\"utf8\");                                         // 48\n                                                                                      // 49\n        if (dataString.length === 0) {                                                // 50\n          lineFor += delimiter;                                                       // 51\n        } else if (typeof data === 'object') {                                        // 52\n                                                                                      // 53\n          // Object is date                                                           // 54\n          if (Object.prototype.toString.call(data) === '[object Date]') {             // 55\n            lineFor += data.toISOString() + delimiter                                 // 56\n          } else {                                                                    // 57\n            lineFor += \"[Object Object]\" + delimiter;                                 // 58\n          }                                                                           // 59\n        }else {                                                                       // 60\n          lineFor += dataString + delimiter;                                          // 61\n        }                                                                             // 62\n      }                                                                               // 63\n    }                                                                                 // 64\n    line = lineFor.slice(0, -1);                                                      // 65\n    str += line + '\\r\\n';                                                             // 66\n  }                                                                                   // 67\n  return str;                                                                         // 68\n};                                                                                    // 69\n                                                                                      // 70\nexportcsv = new ExportCSV();                                                          // 71\n                                                                                      // 72\n////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n//////////////////////////////////////////////////////////////////////////////////////////////\n\n}).call(this);\n\n\n/* Exports */\nPackage._define(\"lfergon:exportcsv\", {\n  exportcsv: exportcsv,\n  saveAs: saveAs\n});\n\n})();\n","servePath":"/packages/lfergon_exportcsv.js"}]